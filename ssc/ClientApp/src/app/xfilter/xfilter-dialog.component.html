<h1 mat-dialog-title>Filter {{title}}</h1>
<form (ngSubmit)="onOk()">
	<div mat-dialog-content>
		<mat-form-field>
			<input matInput [formControl]="itemFilter">
		</mat-form-field>
		<button mat-button type="button" (click)="clearFilter()" [disabled]="data.selected.length == 0 && itemFilter.value == ''" >Clear Filter</button>

		<button *ngIf="format=='number'" mat-button type="button" [matMenuTriggerFor]="number_filterMenu" [ngClass]="(data.selected.length > 0 && data.selected[0].hasOwnProperty('opr') && data.selected[0].hasOwnProperty('val'))? 'x-active' : ''">Number Filter</button>
		<mat-menu #number_filterMenu>
			<ng-container *ngFor="let item of number_filters | keyvalue : asIsOrder; let i = index">
				<button mat-menu-item (click)="selectNumberFilter(item.key)" [ngClass]="(data.selected.length > 0 && item.key == data.selected[0].predef) ? 'x-active' : ''">{{item.value.replace("$","")}}</button>
				<mat-divider *ngIf="item.value.substr(-1) == '$'"></mat-divider>
			</ng-container>
		</mat-menu>

		<!--button mat-button type="button" (click)="openNumberDialog()" *ngIf="format=='number'" [ngClass]="(data.selected.length > 0 && data.selected[0].hasOwnProperty('opr') && data.selected[0].hasOwnProperty('val'))? 'x-active' : ''" >Number Filter</button-->

		<!--mat-form-field *ngIf="format=='date' || format=='datetime'">
			<mat-label>Date Filter</mat-label>
			<mat-select (selectionChange)="selectDateFilter($event)">
				<mat-option *ngFor="let item of date_filters | keyvalue : asIsOrder; let i = index" [value]="item.key">{{item.value}}</mat-option>
			</mat-select>
		</mat-form-field-->

		<button *ngIf="format=='date' || format=='datetime'" mat-button type="button" [matMenuTriggerFor]="date_filterMenu" [ngClass]="(data.selected.length > 0 && data.selected[0].hasOwnProperty('opr') && data.selected[0].hasOwnProperty('val'))? 'x-active' : ''">Date Filter</button>
		<mat-menu #date_filterMenu>
			<ng-container *ngFor="let item of date_filters | keyvalue : asIsOrder; let i = index">
			<button mat-menu-item (click)="selectDateFilter(item.key)" [ngClass]="(data.selected.length > 0 && item.key == data.selected[0].predef) ? 'x-active' : ''">{{item.value.replace("$","")}}</button>
			<mat-divider *ngIf="item.value.substr(-1) == '$'"></mat-divider>
			</ng-container>
		</mat-menu>

		<!--button mat-button type="button" (click)="openDateDialog()" *ngIf="format=='date' || format=='datetime'" [ngClass]="(data.selected.length > 0 && data.selected[0].hasOwnProperty('opr') && data.selected[0].hasOwnProperty('val'))? 'x-active' : ''" >Date Filter</button-->

		<button *ngIf="format=='string'" mat-button type="button" [matMenuTriggerFor]="text_filterMenu" [ngClass]="(data.selected.length > 0 && data.selected[0].hasOwnProperty('opr') && data.selected[0].hasOwnProperty('val'))? 'x-active' : ''">Text Filter</button>
		<mat-menu #text_filterMenu>
			<ng-container *ngFor="let item of text_filters | keyvalue : asIsOrder; let i = index">
				<button mat-menu-item (click)="selectTextFilter(item.key)" [ngClass]="(data.selected.length > 0 && item.key == data.selected[0].predef) ? 'x-active' : ''">{{item.value.replace("$","")}}</button>
				<mat-divider *ngIf="item.value.substr(-1) == '$'"></mat-divider>
			</ng-container>
		</mat-menu>

		<!--button mat-button type="button" (click)="openTextDialog()" *ngIf="format=='string'" [ngClass]="(data.selected.length > 0 && data.selected[0].hasOwnProperty('opr') && data.selected[0].hasOwnProperty('val(Select All) 'x-active' : ''" >Text Filter</button-->

		<div class="loading-shade" *ngIf="isLoadingResults">
		    <mat-spinner *ngIf="isLoadingResults"></mat-spinner>
		</div>
		<mat-checkbox #select_all (change)="toggleSelectAll()">Select All</mat-checkbox>
		<mat-selection-list #list [style.display]="format=='date' ? 'none' : 'auto'" >
			<!--mat-list-option #select_all value="select:all" (click)="toggleSelectAll()" [selected]="isDefaultSelected(item)" >
				(Select All)
			</mat-list-option-->
			<mat-list-option *ngFor="let item of list_items" [value]="item" (click)="toggleItem(item, selected)" [selected]="isDefaultSelected(item)" [ngClass]="format=='number' ? 'number' : ''" >
				{{formatItem(format, item)}}
			</mat-list-option>
		</mat-selection-list>
		<app-xfilter-dialog-tree *ngIf="format=='date'" [items]="list_items" [list]="list" [select_all]="select_all" [select_all_checked]="select_all_checked"></app-xfilter-dialog-tree>
	</div>
	<div mat-dialog-actions>
		<button mat-button type="submit" cdkFocusInitial>Ok</button>
		<!-- <button mat-button type="button" (click)="onOk()">Ok</button> -->
		<button mat-button type="button" (click)="onCancel()">Cancel</button>
	</div>
</form>
